# Инструкция по запуску тестов.

# Инструкция по запуску тестов.

Помимо тестов на корректные выходные данные система автотестирования будет
проверять вашу программу и ее исходный код. Чтобы удачно пройти тестирование, необходимо
убедится, что ваша программа соответствует приведенным ниже требованиям. Для этого
запустите приведенные ниже команды локально и убедитесь, что они не выводят никаких ошибок.

* **Стилевые тесты.** Чтобы проверить, насколько красота вашего кода соответствует
  стандартам, вы можете протестировать ваш код с помощью утилиты _clang-format_. В папке ```materials/linters``` лежит файл ```.clang-format```, который содержит необходимые настройки для стилевого теста. Данный конфигурационный файл распространяет свое действие на все файлы, которые лежат с ним в директории или в директориях ниже. Поэтому, чтобы данные настройки применились к вашим файлам с исходным кодом, скопируйте ```.clang-format``` в папку src. \
  \
  Чтобы запустить проверку на стиль, выполните следующую команду: \
  ```clang-format -n src/sourcefile_name.c``` \
  \
  Для скачивания clang-format, необходимо ввести команду (для MacOS): \
  ```brew install clang-format``` \
  или в случае, когда у вас есть права доступа (для Ubuntu / Linux Mint / Debian) \
  ```sudo apt install clang-format```

  Необходимая версия clang-format: \
  **Mac** 18.1.8 \
  **Linux** 18.1.8


 * **Статический анализ кода.** Иногда (или не совсем иногда) встречается такое, что 
корректно компилирующаяся C-программа работает совершенно неправильно или завершается
   с ошибкой попытки доступа не к своей области памяти. Чтобы предотвратить подобные
   ошибки на этапе написания программы, используют специальные утилиты, которые анализируют
   ваш исходный код на предмет потенциальных ошибок. Наша система автотестов использует
   для этого ```cppcheck```.

   Вы можете протестировать ваш исходный код: \
   ```cppcheck --enable=all --suppress=missingIncludeSystem src/soursefile_name.c``` \
   Также можно проверить сразу все файлы с исходным кодом в директории: \
   ```cppcheck --enable=all --suppress=missingIncludeSystem src/```
    
   Необходимая версия cppcheck: \
   **Mac** 2.13 \
   **Linux** 2.13
   

   **Доп. проверки на корректную работу с памятью.** Как еще один вариант проверки корректности работы с памятью и отслеживания утечек памяти - использование утилиты AddressSanitizer, встроенной в gcc. Отметим сразу, что ее стоит использовать отдельно от leaks или valgrind, т.к. она автоматически встраивается в бинарный файл после компиляции и может конфликтовать с этими утилитами.

  Для ее использования при компиляции указываем флаг `-fsanitize=address`. Например:
  ```
  gcc -o main main.c -fsanitize=address
  ```
  И запускаем собранную программу обычным образом. В таком случае, если есть какие-то ошибки связанные с памятью - они будут выведены в консоль.

  Помимо флага `-fsanitize=address`, можно также использовать следующие флаги:
  * `-fsanitize=leak` - для отслеживания утечек памяти. Но не забывайте также дополнительно проверить утечки при помощи leaks или valgrind.
  * `-fsanitize=undefined` - для обнаружения мест неопределенного поведения программы (например, выход за границы массива или переполнение int'а).
  * `-fsanitize=unreachable` - для обнаружения недостижимых точек программы.

  Больше флагов вы можете найти в документации gcc и AddressSanitizer'а.

